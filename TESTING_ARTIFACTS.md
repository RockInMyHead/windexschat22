# üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (–µ—Å–ª–∏ –µ—â–µ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ)

```bash
npm install
```

### 2. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```bash
npm run init-db
```

### 3. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞ –∏ –∫–ª–∏–µ–Ω—Ç–∞

```bash
npm run dev:full
```

–ò–ª–∏ –æ—Ç–¥–µ–ª—å–Ω–æ:
```bash
# –¢–µ—Ä–º–∏–Ω–∞–ª 1 - –°–µ—Ä–≤–µ—Ä
npm run server

# –¢–µ—Ä–º–∏–Ω–∞–ª 2 - –ö–ª–∏–µ–Ω—Ç
npm run dev

# –¢–µ—Ä–º–∏–Ω–∞–ª 3 - MCP —Å–µ—Ä–≤–µ—Ä (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
npm run mcp
```

## –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ü—Ä–æ—Å—Ç–æ–π –ª–µ–Ω–¥–∏–Ω–≥

**–ó–∞–ø—Ä–æ—Å:**
```
–°–æ–∑–¥–∞–π –ª–µ–Ω–¥–∏–Ω–≥ –¥–ª—è –∫–æ—Ñ–µ–π–Ω–∏ —Å –∫—Ä–∞—Å–∏–≤—ã–º –¥–∏–∑–∞–π–Ω–æ–º
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç intent –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ —Å–∞–π—Ç–∞
- ‚úÖ OpenAI –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π JSON
- ‚úÖ –ê—Ä—Ç–µ—Ñ–∞–∫—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ë–î
- ‚úÖ –í —á–∞—Ç–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è WebsiteArtifactCard —Å Sandpack
- ‚úÖ –ü—Ä–µ–≤—å—é —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Å–∞–π—Ç

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

**–ó–∞–ø—Ä–æ—Å:**
```
–°–¥–µ–ª–∞–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ TODO list —Å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º –∏ —É–¥–∞–ª–µ–Ω–∏–µ–º –∑–∞–¥–∞—á
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ React-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è useState/hooks
- ‚úÖ –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –ø—Ä–µ–≤—å—é
- ‚úÖ –ö–æ–¥ –º–æ–∂–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ Sandpack

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –ú–Ω–æ–≥–æ—Å—Ç—Ä–∞–Ω–∏—á–Ω—ã–π —Å–∞–π—Ç

**–ó–∞–ø—Ä–æ—Å:**
```
–°–æ–∑–¥–∞–π —Å–∞–π—Ç –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ —Å –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π, —Å–µ–∫—Ü–∏—è–º–∏ "–û–±–æ –º–Ω–µ", "–ü—Ä–æ–µ–∫—Ç—ã", "–ö–æ–Ω—Ç–∞–∫—Ç—ã"
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –º–Ω–æ–≥–æ–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- ‚úÖ –ù–∞–≤–∏–≥–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç (React Router –∏–ª–∏ —è–∫–æ—Ä—è)
- ‚úÖ –î–∏–∑–∞–π–Ω —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –∏ –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π

### –°—Ü–µ–Ω–∞—Ä–∏–π 4: –ó–∞–≥—Ä—É–∑–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–∞

1. –°–æ–∑–¥–∞–π—Ç–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç –≤ –æ–¥–Ω–æ–º —á–∞—Ç–µ
2. –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ—Å—å –Ω–∞ –¥—Ä—É–≥–æ–π —á–∞—Ç
3. –í–µ—Ä–Ω–∏—Ç–µ—Å—å –∫ –ø–µ—Ä–≤–æ–º—É —á–∞—Ç—É

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ê—Ä—Ç–µ—Ñ–∞–∫—Ç –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–∑ –ë–î
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≤ —á–∞—Ç–µ
- ‚úÖ Sandpack —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏

## –ü—Ä–æ–≤–µ—Ä–∫–∞ API endpoints

### –°–æ–∑–¥–∞–Ω–∏–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–∞ –≤—Ä—É—á–Ω—É—é

```bash
curl -X POST https://ai.windexs.ru/api/artifacts \
  -H "Content-Type: application/json" \
  -d '{
    "sessionId": 1,
    "type": "website",
    "title": "–¢–µ—Å—Ç–æ–≤—ã–π —Å–∞–π—Ç",
    "files": {
      "/index.html": "<!DOCTYPE html><html><head><title>Test</title><script src=\"https://cdn.tailwindcss.com\"></script></head><body><div id=\"root\"></div><script type=\"module\" src=\"/src/main.tsx\"></script></body></html>",
      "/src/main.tsx": "import React from '\''react'\''\nimport ReactDOM from '\''react-dom/client'\''\nimport App from '\''./App'\''\n\nReactDOM.createRoot(document.getElementById('\''root'\'')!).render(<React.StrictMode><App /></React.StrictMode>)",
      "/src/App.tsx": "export default function App() { return <div className=\"min-h-screen bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center\"><h1 className=\"text-4xl text-white font-bold\">Hello World!</h1></div> }"
    },
    "deps": {
      "react": "^18.2.0",
      "react-dom": "^18.2.0"
    }
  }'
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–∞

```bash
curl https://ai.windexs.ru/api/artifacts/1
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ —Å–µ—Å—Å–∏–∏

```bash
curl https://ai.windexs.ru/api/sessions/1/artifacts
```

## –û—Ç–ª–∞–¥–∫–∞

### –í–∫–ª—é—á–∏—Ç—å –ø–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í `openai.ts` –∏ `server.js` —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã console.log –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏:

```javascript
console.log('üé® Website intent detected...');
console.log('‚úÖ Artifact created with ID:', artifactId);
console.log('‚ùå Failed to generate artifact:', error);
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ Sandpack

–ï—Å–ª–∏ Sandpack –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

1. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞:**
```bash
npm list @codesandbox/sandpack-react
```

2. **–ö–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞:**
–î–æ–ª–∂–Ω–æ –±—ã—Ç—å –±–µ–∑ –æ—à–∏–±–æ–∫ –ø—Ä–∏ —Ä–µ–Ω–¥–µ—Ä–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞

3. **Network tab:**
Sandpack –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Ä–µ—Å—É—Ä—Å—ã –∏–∑ unpkg.com - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–µ—Ç–µ–≤—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ë–î

```bash
sqlite3 windexs_chat.db

# –í sqlite3 REPL:
.tables                    # –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Ç–∞–±–ª–∏—Ü–∞ artifacts
SELECT * FROM artifacts;   # –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤
SELECT * FROM messages WHERE artifact_id IS NOT NULL;  # –°–æ–æ–±—â–µ–Ω–∏—è —Å –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–∞–º–∏
.quit
```

## –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º–∞: OpenAI –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç markdown –≤–º–µ—Å—Ç–æ —á–∏—Å—Ç–æ–≥–æ JSON

**–†–µ—à–µ–Ω–∏–µ:** –£–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞:
```javascript
const jsonMatch = content.match(/```json\s*([\s\S]*?)\s*```/);
const jsonString = jsonMatch ? jsonMatch[1] : content;
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ê—Ä—Ç–µ—Ñ–∞–∫—Ç —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π

**–†–µ—à–µ–Ω–∏–µ:** –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ª–∏–º–∏—Ç 400KB. –ï—Å–ª–∏ –ø—Ä–µ–≤—ã—à–µ–Ω:
```json
{
  "error": "Artifact too large",
  "maxSize": "400KB",
  "actualSize": "450KB"
}
```

–ü–æ–ø—Ä–æ—Å–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —É—Ç–æ—á–Ω–∏—Ç—å –∑–∞–ø—Ä–æ—Å –∏–ª–∏ —É–ø—Ä–æ—Å—Ç–∏—Ç—å —Å–∞–π—Ç.

### –ü—Ä–æ–±–ª–µ–º–∞: Missing required files

**–†–µ—à–µ–Ω–∏–µ:** OpenAI –¥–æ–ª–∂–µ–Ω –≤–∫–ª—é—á–∞—Ç—å `/index.html`, `/src/main.tsx`, `/src/App.tsx`.
–ï—Å–ª–∏ –Ω–µ –≤–∫–ª—é—á–∞–µ—Ç - —É–ª—É—á—à–∏—Ç–µ system prompt –∏–ª–∏ –ø–µ—Ä–µ—Ñ–æ—Ä–º—É–ª–∏—Ä—É–π—Ç–µ –∑–∞–ø—Ä–æ—Å.

### –ü—Ä–æ–±–ª–µ–º–∞: Sandpack –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ—à–∏–±–∫–∏ –≤ –∫–æ–¥–µ

**–†–µ—à–µ–Ω–∏–µ:** 
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å TypeScript —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –∏–º–ø–æ—Ä—Ç—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ React –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω –≥–¥–µ –Ω—É–∂–Ω–æ

## –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –¢–∏–ø–∏—á–Ω–æ–µ –≤—Ä–µ–º—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

- **gpt-4o-mini**: 3-8 —Å–µ–∫—É–Ω–¥
- **gpt-4o**: 5-15 —Å–µ–∫—É–Ω–¥

### –†–∞–∑–º–µ—Ä —Ç–∏–ø–∏—á–Ω–æ–≥–æ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–∞

- –ü—Ä–æ—Å—Ç–æ–π –ª–µ–Ω–¥–∏–Ω–≥: 5-15 KB
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–µ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏: 15-40 KB
- –ë–æ–ª—å—à–æ–π –º–Ω–æ–≥–æ—Å—Ç—Ä–∞–Ω–∏—á–Ω—ã–π —Å–∞–π—Ç: 40-100 KB

## –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ç–∏–ø–æ–≤ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤

1. –û–±–Ω–æ–≤–∏—Ç–µ ENUM –≤ database.js:
```javascript
type TEXT NOT NULL CHECK (type IN ('website', 'document', 'chart'))
```

2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è —Ä–µ–Ω–¥–µ—Ä–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `DocumentArtifactCard`)

3. –î–æ–±–∞–≤—å—Ç–µ –¥–µ—Ç–µ–∫—Ü–∏—é intent –≤ `openai.ts`

4. –û–±–Ω–æ–≤–∏—Ç–µ —É—Å–ª–æ–≤–∏–µ —Ä–µ–Ω–¥–µ—Ä–∞ –≤ `Chat.tsx`:
```tsx
{message.artifactId && artifacts.has(message.artifactId) && (
  artifacts.get(message.artifactId)!.type === 'website' ? (
    <WebsiteArtifactCard artifact={artifacts.get(message.artifactId)!} />
  ) : (
    <DocumentArtifactCard artifact={artifacts.get(message.artifactId)!} />
  )
)}
```

## –ß–µ–∫-–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º

- [ ] –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞
- [ ] –í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
- [ ] OPENAI_API_KEY –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ .env
- [ ] –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- [ ] –ö–ª–∏–µ–Ω—Ç –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- [ ] –¢–µ—Å—Ç–æ–≤—ã–π –∞—Ä—Ç–µ—Ñ–∞–∫—Ç —Å–æ–∑–¥–∞–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ
- [ ] Sandpack –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] API endpoints –æ—Ç–≤–µ—á–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞: `npm run server`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12)
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Network tab –Ω–∞ –Ω–∞–ª–∏—á–∏–µ failed requests
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ë–î: `sqlite3 windexs_chat.db`

–°–æ–∑–¥–∞–π—Ç–µ issue —Å:
- –û–ø–∏—Å–∞–Ω–∏–µ–º –ø—Ä–æ–±–ª–µ–º—ã
- –®–∞–≥–∞–º–∏ –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è
- –õ–æ–≥–∞–º–∏ —Å–µ—Ä–≤–µ—Ä–∞ –∏ –±—Ä–∞—É–∑–µ—Ä–∞
- –í–µ—Ä—Å–∏–µ–π Node.js –∏ npm
